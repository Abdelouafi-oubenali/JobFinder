<h2>Mes favoris</h2>

<div *ngIf="loading">Chargement...</div>

<div *ngIf="error">{{ error }}</div>

<ul *ngIf="!loading && jobs.length">
  <li *ngFor="let job of jobs">
    <h3>{{ job.name }}</h3>
    <p>{{ job.company?.name }}</p>
    <p>{{ job.locations[0]?.name }}</p>

    <div style="display:flex;gap:0.5rem;margin-top:0.5rem;">
      <button (click)="showDetails(job)" style="padding:0.35rem 0.6rem">{{ job._expanded ? 'Masquer' : 'Détails' }}</button>
      <button (click)="apply(job)" style="padding:0.35rem 0.6rem">Postuler</button>
      <button (click)="toggleFavorite(job)" style="padding:0.35rem 0.6rem">{{ isFavorite(job) ? '★ Favori' : '☆ Favori' }}</button>
    </div>

    <div *ngIf="job._expanded" style="margin-top:0.5rem;border-top:1px solid #eee;padding-top:0.5rem;">
      <p *ngIf="job.contents; else desc" [innerHTML]="job.contents"></p>
      <ng-template #desc>
        <p>{{ job.description || job.contents?.text || 'Pas de description disponible.' }}</p>
      </ng-template>
    </div>
  </li>
</ul>

<div *ngIf="!loading && !jobs.length">Aucune offre favorite trouvée.</div>
